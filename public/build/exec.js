var clio=function(exports){"use strict";var global=void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},lookup$1=[],revLookup$1=[],Arr$1="undefined"!=typeof Uint8Array?Uint8Array:Array,inited=!1;function init(){inited=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=t.length;e<r;++e)lookup$1[e]=t[e],revLookup$1[t.charCodeAt(e)]=e;revLookup$1["-".charCodeAt(0)]=62,revLookup$1["_".charCodeAt(0)]=63}function toByteArray$1(t){var e,r,n,i,s,o;inited||init();var f=t.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s="="===t[f-2]?2:"="===t[f-1]?1:0,o=new Arr$1(3*f/4-s),n=s>0?f-4:f;var a=0;for(e=0,r=0;e<n;e+=4,r+=3)i=revLookup$1[t.charCodeAt(e)]<<18|revLookup$1[t.charCodeAt(e+1)]<<12|revLookup$1[t.charCodeAt(e+2)]<<6|revLookup$1[t.charCodeAt(e+3)],o[a++]=i>>16&255,o[a++]=i>>8&255,o[a++]=255&i;return 2===s?(i=revLookup$1[t.charCodeAt(e)]<<2|revLookup$1[t.charCodeAt(e+1)]>>4,o[a++]=255&i):1===s&&(i=revLookup$1[t.charCodeAt(e)]<<10|revLookup$1[t.charCodeAt(e+1)]<<4|revLookup$1[t.charCodeAt(e+2)]>>2,o[a++]=i>>8&255,o[a++]=255&i),o}function tripletToBase64$1(t){return lookup$1[t>>18&63]+lookup$1[t>>12&63]+lookup$1[t>>6&63]+lookup$1[63&t]}function encodeChunk$1(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16)+(t[s+1]<<8)+t[s+2],i.push(tripletToBase64$1(n));return i.join("")}function fromByteArray$1(t){var e;inited||init();for(var r=t.length,n=r%3,i="",s=[],o=16383,f=0,a=r-n;f<a;f+=o)s.push(encodeChunk$1(t,f,f+o>a?a:f+o));return 1===n?(e=t[r-1],i+=lookup$1[e>>2],i+=lookup$1[e<<4&63],i+="=="):2===n&&(e=(t[r-2]<<8)+t[r-1],i+=lookup$1[e>>10],i+=lookup$1[e>>4&63],i+=lookup$1[e<<2&63],i+="="),s.push(i),s.join("")}function read(t,e,r,n,i){var s,o,f=8*i-n-1,a=(1<<f)-1,u=a>>1,h=-7,c=r?i-1:0,l=r?-1:1,p=t[e+c];for(c+=l,s=p&(1<<-h)-1,p>>=-h,h+=f;h>0;s=256*s+t[e+c],c+=l,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=n;h>0;o=256*o+t[e+c],c+=l,h-=8);if(0===s)s=1-u;else{if(s===a)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=u}return(p?-1:1)*o*Math.pow(2,s-n)}function write(t,e,r,n,i,s){var o,f,a,u=8*s-i-1,h=(1<<u)-1,c=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,g=n?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(f=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-o))<1&&(o--,a*=2),(e+=o+c>=1?l/a:l*Math.pow(2,1-c))*a>=2&&(o++,a/=2),o+c>=h?(f=0,o=h):o+c>=1?(f=(e*a-1)*Math.pow(2,i),o+=c):(f=e*Math.pow(2,c-1)*Math.pow(2,i),o=0));i>=8;t[r+p]=255&f,p+=g,f/=256,i-=8);for(o=o<<i|f,u+=i;u>0;t[r+p]=255&o,p+=g,o/=256,u-=8);t[r+p-g]|=128*d}var toString={}.toString,isArray=Array.isArray||function(t){return"[object Array]"==toString.call(t)},INSPECT_MAX_BYTES=50;Buffer.TYPED_ARRAY_SUPPORT=void 0===global.TYPED_ARRAY_SUPPORT||global.TYPED_ARRAY_SUPPORT;var _kMaxLength=kMaxLength();function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(t,e){if(kMaxLength()<e)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=Buffer.prototype:(null===t&&(t=new Buffer(e)),t.length=e),t}function Buffer(t,e,r){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,t)}return from(this,t,e,r)}function from(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?fromArrayBuffer(t,e,r,n):"string"==typeof e?fromString(t,e,r):fromObject(t,e)}function assertSize(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function alloc(t,e,r,n){return assertSize(e),e<=0?createBuffer(t,e):void 0!==r?"string"==typeof n?createBuffer(t,e).fill(r,n):createBuffer(t,e).fill(r):createBuffer(t,e)}function allocUnsafe(t,e){if(assertSize(e),t=createBuffer(t,e<0?0:0|checked(e)),!Buffer.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function fromString(t,e,r){if("string"==typeof r&&""!==r||(r="utf8"),!Buffer.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|byteLength$1(e,r),i=(t=createBuffer(t,n)).write(e,r);return i!==n&&(t=t.slice(0,i)),t}function fromArrayLike(t,e){var r=e.length<0?0:0|checked(e.length);t=createBuffer(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function fromArrayBuffer(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n),Buffer.TYPED_ARRAY_SUPPORT?(t=e).__proto__=Buffer.prototype:t=fromArrayLike(t,e),t}function fromObject(t,e){if(internalIsBuffer(e)){var r=0|checked(e.length);return 0===(t=createBuffer(t,r)).length||e.copy(t,0,0,r),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||isnan(e.length)?createBuffer(t,0):fromArrayLike(t,e);if("Buffer"===e.type&&isArray(e.data))return fromArrayLike(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(t){if(t>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|t}function SlowBuffer(t){return+t!=t&&(t=0),Buffer.alloc(+t)}function internalIsBuffer(t){return!(null==t||!t._isBuffer)}function byteLength$1(t,e){if(internalIsBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return utf8ToBytes(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(t).length;default:if(n)return utf8ToBytes(t).length;e=(""+e).toLowerCase(),n=!0}}function slowToString(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return hexSlice(this,e,r);case"utf8":case"utf-8":return utf8Slice(this,e,r);case"ascii":return asciiSlice(this,e,r);case"latin1":case"binary":return latin1Slice(this,e,r);case"base64":return base64Slice(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function swap(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function bidirectionalIndexOf(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=Buffer.from(e,n)),internalIsBuffer(e))return 0===e.length?-1:arrayIndexOf(t,e,r,n,i);if("number"==typeof e)return e&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):arrayIndexOf(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(t,e,r,n,i){var s,o=1,f=t.length,a=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,f/=2,a/=2,r/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var h=-1;for(s=r;s<f;s++)if(u(t,s)===u(e,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===a)return h*o}else-1!==h&&(s-=s-h),h=-1}else for(r+a>f&&(r=f-a),s=r;s>=0;s--){for(var c=!0,l=0;l<a;l++)if(u(t,s+l)!==u(e,l)){c=!1;break}if(c)return s}return-1}function hexWrite(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");n>s/2&&(n=s/2);for(var o=0;o<n;++o){var f=parseInt(e.substr(2*o,2),16);if(isNaN(f))return o;t[r+o]=f}return o}function utf8Write(t,e,r,n){return blitBuffer(utf8ToBytes(e,t.length-r),t,r,n)}function asciiWrite(t,e,r,n){return blitBuffer(asciiToBytes(e),t,r,n)}function latin1Write(t,e,r,n){return asciiWrite(t,e,r,n)}function base64Write(t,e,r,n){return blitBuffer(base64ToBytes(e),t,r,n)}function ucs2Write(t,e,r,n){return blitBuffer(utf16leToBytes(e,t.length-r),t,r,n)}function base64Slice(t,e,r){return 0===e&&r===t.length?fromByteArray$1(t):fromByteArray$1(t.slice(e,r))}function utf8Slice(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var s,o,f,a,u=t[i],h=null,c=u>239?4:u>223?3:u>191?2:1;if(i+c<=r)switch(c){case 1:u<128&&(h=u);break;case 2:128==(192&(s=t[i+1]))&&(a=(31&u)<<6|63&s)>127&&(h=a);break;case 3:s=t[i+1],o=t[i+2],128==(192&s)&&128==(192&o)&&(a=(15&u)<<12|(63&s)<<6|63&o)>2047&&(a<55296||a>57343)&&(h=a);break;case 4:s=t[i+1],o=t[i+2],f=t[i+3],128==(192&s)&&128==(192&o)&&128==(192&f)&&(a=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&f)>65535&&a<1114112&&(h=a)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=c}return decodeCodePointsArray(n)}Buffer.poolSize=8192,Buffer._augment=function(t){return t.__proto__=Buffer.prototype,t},Buffer.from=function(t,e,r){return from(null,t,e,r)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array),Buffer.alloc=function(t,e,r){return alloc(null,t,e,r)},Buffer.allocUnsafe=function(t){return allocUnsafe(null,t)},Buffer.allocUnsafeSlow=function(t){return allocUnsafe(null,t)},Buffer.isBuffer=isBuffer,Buffer.compare=function(t,e){if(!internalIsBuffer(t)||!internalIsBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,s=Math.min(r,n);i<s;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},Buffer.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(t,e){if(!isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Buffer.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=Buffer.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var s=t[r];if(!internalIsBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},Buffer.byteLength=byteLength$1,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)swap(this,e,e+1);return this},Buffer.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)swap(this,e,e+3),swap(this,e+1,e+2);return this},Buffer.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)swap(this,e,e+7),swap(this,e+1,e+6),swap(this,e+2,e+5),swap(this,e+3,e+4);return this},Buffer.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?utf8Slice(this,0,t):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(t){if(!internalIsBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Buffer.compare(this,t)},Buffer.prototype.inspect=function(){var t="",e=INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},Buffer.prototype.compare=function(t,e,r,n,i){if(!internalIsBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(e>>>=0),f=Math.min(s,o),a=this.slice(n,i),u=t.slice(e,r),h=0;h<f;++h)if(a[h]!==u[h]){s=a[h],o=u[h];break}return s<o?-1:o<s?1:0},Buffer.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},Buffer.prototype.indexOf=function(t,e,r){return bidirectionalIndexOf(this,t,e,r,!0)},Buffer.prototype.lastIndexOf=function(t,e,r){return bidirectionalIndexOf(this,t,e,r,!1)},Buffer.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return hexWrite(this,t,e,r);case"utf8":case"utf-8":return utf8Write(this,t,e,r);case"ascii":return asciiWrite(this,t,e,r);case"latin1":case"binary":return latin1Write(this,t,e,r);case"base64":return base64Write(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(t){var e=t.length;if(e<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=MAX_ARGUMENTS_LENGTH));return r}function asciiSlice(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function latin1Slice(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function hexSlice(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=e;s<r;++s)i+=toHex(t[s]);return i}function utf16leSlice(t,e,r){for(var n=t.slice(e,r),i="",s=0;s<n.length;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function checkOffset(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(t,e,r,n,i,s){if(!internalIsBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function objectWriteUInt16(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,s=Math.min(t.length-r,2);i<s;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function objectWriteUInt32(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,s=Math.min(t.length-r,4);i<s;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function checkIEEE754(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(t,e,r,n,i){return i||checkIEEE754(t,e,r,4),write(t,e,r,n,23,4),r+4}function writeDouble(t,e,r,n,i){return i||checkIEEE754(t,e,r,8),write(t,e,r,n,52,8),r+8}Buffer.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),Buffer.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=Buffer.prototype;else{var i=e-t;r=new Buffer(i,void 0);for(var s=0;s<i;++s)r[s]=this[s+t]}return r},Buffer.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=this[t],i=1,s=0;++s<e&&(i*=256);)n+=this[t+s]*i;return n},Buffer.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},Buffer.prototype.readUInt8=function(t,e){return e||checkOffset(t,1,this.length),this[t]},Buffer.prototype.readUInt16LE=function(t,e){return e||checkOffset(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUInt16BE=function(t,e){return e||checkOffset(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUInt32LE=function(t,e){return e||checkOffset(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUInt32BE=function(t,e){return e||checkOffset(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=this[t],i=1,s=0;++s<e&&(i*=256);)n+=this[t+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},Buffer.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=e,i=1,s=this[t+--n];n>0&&(i*=256);)s+=this[t+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},Buffer.prototype.readInt8=function(t,e){return e||checkOffset(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Buffer.prototype.readInt16LE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(t,e){return e||checkOffset(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function(t,e){return e||checkOffset(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readFloatLE=function(t,e){return e||checkOffset(t,4,this.length),read(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function(t,e){return e||checkOffset(t,4,this.length),read(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function(t,e){return e||checkOffset(t,8,this.length),read(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function(t,e){return e||checkOffset(t,8,this.length),read(this,t,!1,52,8)},Buffer.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||checkInt(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,s=0;for(this[e]=255&t;++s<r&&(i*=256);)this[e+s]=t/i&255;return e+r},Buffer.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||checkInt(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+r},Buffer.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},Buffer.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);checkInt(this,t,e,r,i-1,-i)}var s=0,o=1,f=0;for(this[e]=255&t;++s<r&&(o*=256);)t<0&&0===f&&0!==this[e+s-1]&&(f=1),this[e+s]=(t/o>>0)-f&255;return e+r},Buffer.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);checkInt(this,t,e,r,i-1,-i)}var s=r-1,o=1,f=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===f&&0!==this[e+s+1]&&(f=1),this[e+s]=(t/o>>0)-f&255;return e+r},Buffer.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},Buffer.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeFloatLE=function(t,e,r){return writeFloat(this,t,e,!0,r)},Buffer.prototype.writeFloatBE=function(t,e,r){return writeFloat(this,t,e,!1,r)},Buffer.prototype.writeDoubleLE=function(t,e,r){return writeDouble(this,t,e,!0,r)},Buffer.prototype.writeDoubleBE=function(t,e,r){return writeDouble(this,t,e,!1,r)},Buffer.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,s=n-r;if(this===t&&r<e&&e<n)for(i=s-1;i>=0;--i)t[i+e]=this[i+r];else if(s<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+s),e);return s},Buffer.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var o=internalIsBuffer(t)?t:utf8ToBytes(new Buffer(t,n).toString()),f=o.length;for(s=0;s<r-e;++s)this[s+e]=o[s%f]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(t){if((t=stringtrim(t).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function stringtrim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function toHex(t){return t<16?"0"+t.toString(16):t.toString(16)}function utf8ToBytes(t,e){var r;e=e||1/0;for(var n=t.length,i=null,s=[],o=0;o<n;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function asciiToBytes(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function utf16leToBytes(t,e){for(var r,n,i,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(r=t.charCodeAt(o))>>8,i=r%256,s.push(i),s.push(n);return s}function base64ToBytes(t){return toByteArray$1(base64clean(t))}function blitBuffer(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function isnan(t){return t!=t}function isBuffer(t){return null!=t&&(!!t._isBuffer||isFastBuffer(t)||isSlowBuffer(t))}function isFastBuffer(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function isSlowBuffer(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&isFastBuffer(t.slice(0,0))}var _polyfillNode_buffer=Object.freeze({__proto__:null,Buffer:Buffer,INSPECT_MAX_BYTES:INSPECT_MAX_BYTES,SlowBuffer:SlowBuffer,isBuffer:isBuffer,kMaxLength:_kMaxLength});const TYPES={PACKET:0,PAYLOAD:1,REGISTER:2,GET:3,PATH:4,CALL:5,RESULT:6,EVENT:7};function getAugmentedNamespace(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})})),e}Object.fromEntries(Object.entries(TYPES).map((([t,e])=>[t,15+e])));var buffer={},base64Js={};base64Js.byteLength=byteLength,base64Js.toByteArray=toByteArray,base64Js.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function byteLength(t){var e=getLens(t),r=e[0],n=e[1];return 3*(r+n)/4-n}function _byteLength(t,e,r){return 3*(e+r)/4-r}function toByteArray(t){var e,r,n=getLens(t),i=n[0],s=n[1],o=new Arr(_byteLength(t,i,s)),f=0,a=s>0?i-4:i;for(r=0;r<a;r+=4)e=revLookup[t.charCodeAt(r)]<<18|revLookup[t.charCodeAt(r+1)]<<12|revLookup[t.charCodeAt(r+2)]<<6|revLookup[t.charCodeAt(r+3)],o[f++]=e>>16&255,o[f++]=e>>8&255,o[f++]=255&e;return 2===s&&(e=revLookup[t.charCodeAt(r)]<<2|revLookup[t.charCodeAt(r+1)]>>4,o[f++]=255&e),1===s&&(e=revLookup[t.charCodeAt(r)]<<10|revLookup[t.charCodeAt(r+1)]<<4|revLookup[t.charCodeAt(r+2)]>>2,o[f++]=e>>8&255,o[f++]=255&e),o}function tripletToBase64(t){return lookup[t>>18&63]+lookup[t>>12&63]+lookup[t>>6&63]+lookup[63&t]}function encodeChunk(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),i.push(tripletToBase64(n));return i.join("")}function fromByteArray(t){for(var e,r=t.length,n=r%3,i=[],s=16383,o=0,f=r-n;o<f;o+=s)i.push(encodeChunk(t,o,o+s>f?f:o+s));return 1===n?(e=t[r-1],i.push(lookup[e>>2]+lookup[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],i.push(lookup[e>>10]+lookup[e>>4&63]+lookup[e<<2&63]+"=")),i.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;var ieee754={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(t,e,r,n,i){var s,o,f=8*i-n-1,a=(1<<f)-1,u=a>>1,h=-7,c=r?i-1:0,l=r?-1:1,p=t[e+c];for(c+=l,s=p&(1<<-h)-1,p>>=-h,h+=f;h>0;s=256*s+t[e+c],c+=l,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=n;h>0;o=256*o+t[e+c],c+=l,h-=8);if(0===s)s=1-u;else{if(s===a)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=u}return(p?-1:1)*o*Math.pow(2,s-n)},write:function(t,e,r,n,i,s){var o,f,a,u=8*s-i-1,h=(1<<u)-1,c=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,g=n?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(f=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-o))<1&&(o--,a*=2),(e+=o+c>=1?l/a:l*Math.pow(2,1-c))*a>=2&&(o++,a/=2),o+c>=h?(f=0,o=h):o+c>=1?(f=(e*a-1)*Math.pow(2,i),o+=c):(f=e*Math.pow(2,c-1)*Math.pow(2,i),o=0));i>=8;t[r+p]=255&f,p+=g,f/=256,i-=8);for(o=o<<i|f,u+=i;u>0;t[r+p]=255&o,p+=g,o/=256,u-=8);t[r+p-g]|=128*d}};
/*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   */
!function(t){var e=base64Js,r=ieee754,n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=o,t.SlowBuffer=function(t){+t!=t&&(t=0);return o.alloc(+t)},t.INSPECT_MAX_BYTES=50;var i=2147483647;function s(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,o.prototype),e}function o(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return f(t,e,r)}function f(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!o.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|p(t,e),n=s(r),i=n.write(t,e);i!==r&&(n=n.slice(0,i));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(z(t,Uint8Array)){var e=new Uint8Array(t);return c(e.buffer,e.byteOffset,e.byteLength)}return h(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(z(t,ArrayBuffer)||t&&z(t.buffer,ArrayBuffer))return c(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(z(t,SharedArrayBuffer)||t&&z(t.buffer,SharedArrayBuffer)))return c(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return o.from(n,e,r);var i=function(t){if(o.isBuffer(t)){var e=0|l(t.length),r=s(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||j(t.length)?s(0):h(t);if("Buffer"===t.type&&Array.isArray(t.data))return h(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return o.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return a(t),s(t<0?0:0|l(t))}function h(t){for(var e=t.length<0?0:0|l(t.length),r=s(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function c(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,o.prototype),n}function l(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function p(t,e){if(o.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||z(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Y(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return M(t).length;default:if(i)return n?-1:Y(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return _(this,e,r);case"utf8":case"utf-8":return B(this,e,r);case"ascii":return T(this,e,r);case"latin1":case"binary":return k(this,e,r);case"base64":return I(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function d(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function y(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),j(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=o.from(e,n)),o.isBuffer(e))return 0===e.length?-1:w(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):w(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function w(t,e,r,n,i){var s,o=1,f=t.length,a=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,f/=2,a/=2,r/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var h=-1;for(s=r;s<f;s++)if(u(t,s)===u(e,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===a)return h*o}else-1!==h&&(s-=s-h),h=-1}else for(r+a>f&&(r=f-a),s=r;s>=0;s--){for(var c=!0,l=0;l<a;l++)if(u(t,s+l)!==u(e,l)){c=!1;break}if(c)return s}return-1}function m(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=e.length;n>s/2&&(n=s/2);for(var o=0;o<n;++o){var f=parseInt(e.substr(2*o,2),16);if(j(f))return o;t[r+o]=f}return o}function b(t,e,r,n){return O(Y(e,t.length-r),t,r,n)}function E(t,e,r,n){return O(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function S(t,e,r,n){return O(M(e),t,r,n)}function v(t,e,r,n){return O(function(t,e){for(var r,n,i,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(r=t.charCodeAt(o))>>8,i=r%256,s.push(i),s.push(n);return s}(e,t.length-r),t,r,n)}function I(t,r,n){return 0===r&&n===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(r,n))}function B(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var s,o,f,a,u=t[i],h=null,c=u>239?4:u>223?3:u>191?2:1;if(i+c<=r)switch(c){case 1:u<128&&(h=u);break;case 2:128==(192&(s=t[i+1]))&&(a=(31&u)<<6|63&s)>127&&(h=a);break;case 3:s=t[i+1],o=t[i+2],128==(192&s)&&128==(192&o)&&(a=(15&u)<<12|(63&s)<<6|63&o)>2047&&(a<55296||a>57343)&&(h=a);break;case 4:s=t[i+1],o=t[i+2],f=t[i+3],128==(192&s)&&128==(192&o)&&128==(192&f)&&(a=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&f)>65535&&a<1114112&&(h=a)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=c}return function(t){var e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=A));return r}(n)}t.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(t,e,r){return f(t,e,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(t,e,r){return function(t,e,r){return a(t),t<=0?s(t):void 0!==e?"string"==typeof r?s(t).fill(e,r):s(t).fill(e):s(t)}(t,e,r)},o.allocUnsafe=function(t){return u(t)},o.allocUnsafeSlow=function(t){return u(t)},o.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==o.prototype},o.compare=function(t,e){if(z(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),z(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,i=0,s=Math.min(r,n);i<s;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=o.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var s=t[r];if(z(s,Uint8Array))i+s.length>n.length?o.from(s).copy(n,i):Uint8Array.prototype.set.call(n,s,i);else{if(!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i)}i+=s.length}return n},o.byteLength=p,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)d(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},o.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?B(this,0,t):g.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=function(t,e,r,n,i){if(z(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(n>>>=0),f=(r>>>=0)-(e>>>=0),a=Math.min(s,f),u=this.slice(n,i),h=t.slice(e,r),c=0;c<a;++c)if(u[c]!==h[c]){s=u[c],f=h[c];break}return s<f?-1:f<s?1:0},o.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},o.prototype.indexOf=function(t,e,r){return y(this,t,e,r,!0)},o.prototype.lastIndexOf=function(t,e,r){return y(this,t,e,r,!1)},o.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return m(this,t,e,r);case"utf8":case"utf-8":return b(this,t,e,r);case"ascii":case"latin1":case"binary":return E(this,t,e,r);case"base64":return S(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function T(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function k(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function _(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=e;s<r;++s)i+=N[t[s]];return i}function U(t,e,r){for(var n=t.slice(e,r),i="",s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function C(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function P(t,e,r,n,i,s){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function L(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function R(t,e,n,i,s){return e=+e,n>>>=0,s||L(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function x(t,e,n,i,s){return e=+e,n>>>=0,s||L(t,0,n,8),r.write(t,e,n,i,52,8),n+8}o.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,o.prototype),n},o.prototype.readUintLE=o.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);for(var n=this[t],i=1,s=0;++s<e&&(i*=256);)n+=this[t+s]*i;return n},o.prototype.readUintBE=o.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},o.prototype.readUint8=o.prototype.readUInt8=function(t,e){return t>>>=0,e||C(t,1,this.length),this[t]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(t,e){return t>>>=0,e||C(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(t,e){return t>>>=0,e||C(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(t,e){return t>>>=0,e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(t,e){return t>>>=0,e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);for(var n=this[t],i=1,s=0;++s<e&&(i*=256);)n+=this[t+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},o.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);for(var n=e,i=1,s=this[t+--n];n>0&&(i*=256);)s+=this[t+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},o.prototype.readInt8=function(t,e){return t>>>=0,e||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,e){t>>>=0,e||C(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(t,e){t>>>=0,e||C(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(t,e){return t>>>=0,e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return t>>>=0,e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return t>>>=0,e||C(t,4,this.length),r.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return t>>>=0,e||C(t,4,this.length),r.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return t>>>=0,e||C(t,8,this.length),r.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return t>>>=0,e||C(t,8,this.length),r.read(this,t,!1,52,8)},o.prototype.writeUintLE=o.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||P(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,s=0;for(this[e]=255&t;++s<r&&(i*=256);)this[e+s]=t/i&255;return e+r},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||P(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+r},o.prototype.writeUint8=o.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,1,255,0),this[e]=255&t,e+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);P(this,t,e,r,i-1,-i)}var s=0,o=1,f=0;for(this[e]=255&t;++s<r&&(o*=256);)t<0&&0===f&&0!==this[e+s-1]&&(f=1),this[e+s]=(t/o>>0)-f&255;return e+r},o.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);P(this,t,e,r,i-1,-i)}var s=r-1,o=1,f=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===f&&0!==this[e+s+1]&&(f=1),this[e+s]=(t/o>>0)-f&255;return e+r},o.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},o.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeFloatLE=function(t,e,r){return R(this,t,e,!0,r)},o.prototype.writeFloatBE=function(t,e,r){return R(this,t,e,!1,r)},o.prototype.writeDoubleLE=function(t,e,r){return x(this,t,e,!0,r)},o.prototype.writeDoubleBE=function(t,e,r){return x(this,t,e,!1,r)},o.prototype.copy=function(t,e,r,n){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},o.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var i=t.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var f=o.isBuffer(t)?t:o.from(t,n),a=f.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=f[s%a]}return this};var $=/[^+/0-9A-Za-z-_]/g;function Y(t,e){var r;e=e||1/0;for(var n=t.length,i=null,s=[],o=0;o<n;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function M(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace($,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function O(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function z(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function j(t){return t!=t}var N=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)e[n+i]=t[r]+t[i];return e}()}(buffer);const BufferClass$1=void 0===Buffer?buffer.Buffer:Buffer,createServer=null,connect=null,randomId$1=t=>[...Array(t)].map((()=>(~~(36*Math.random())).toString(36))).join(""),isRegExp=t=>"[object RegExp]"===Object.prototype.toString.call(t);class EventEmitter{constructor(t){this.id=t||"emitter."+randomId$1(64),this.resource=null,this.listeners={},this.regexListeners={}}emit(event,...args){this.listeners[event]=this.listeners[event]||[],this.listeners[event].forEach((t=>t(...args)));for(const[pattern,fns]of Object.entries(this.regexListeners)){const regex=eval(pattern);event.match(regex)&&fns.forEach((t=>t(event,...args)))}return this}emitUnless(callback,event,...args){this.listeners[event]=this.listeners[event]||[],this.listeners[event].filter((t=>t!==callback)).forEach((t=>t(...args)));for(const[pattern,fns]of Object.entries(this.regexListeners)){const regex=eval(pattern);event.match(regex)&&fns.filter((t=>t!==callback)).forEach((t=>t(event,...args)))}return this}on(t,e){const r=isRegExp(t)?this.regexListeners:this.listeners;return r[t]=r[t]||[],r[t].push(e),this}off(t,e){const r=isRegExp(t)?this.regexListeners:this.listeners;return r[t]=r[t]||[],r[t]=r[t].filter((t=>t!==e)),this}}function emitter(){return new EventEmitter}class Range{constructor(t=0,e=1/0,r,n){this.start=t,this.end=e,this.step=r||(e>t?1:-1),this.mapfn=n,this.index=0}get length(){return Math.floor((this.end-this.start)/this.step)}map(t){const e=this.mapfn?(e,r,n)=>t(this.mapfn(e,r,n),r,n):t;return new Range(this.start,this.end,this.step,e)}get(t){const e=this.start+this.step*t;if(!(e>this.end))return this.mapfn?this.mapfn(e,t,this):e}take(t){return new Range(this.start,this.start+t*this.step,this.step,this.mapfn)}skip(t){return new Range(this.start+t*this.step,this.end,this.step,this.mapfn)}slice(t,e){return this.skip(t).take(e-t)}toArray(){return[...this]}toString(){return`[${this.start}:${this.end}:${this.step}]`}next(){const t=this.start+this.step*this.index,e=t>=this.end,r=this.mapfn?this.mapfn(t,this.index,this):t;return e?this.index=0:this.index++,{value:r,done:e}}[Symbol.iterator](){return this}}const range=(t,e,r)=>new Range(t,e,r),getIndex=(t,e)=>{const r=t instanceof Range;return e=e>=0?e:t.length-e,r?t.get(e):t[e]},numberSlice=(t,e)=>getIndex(t,e),rangeSlice=(t,e)=>{const r=[];for(const n of e){if(n>t.length)return r;r.push(getIndex(t,n))}return r},arraySlice=(t,e)=>e.map(((e,r)=>isNumber(e)?getIndex(t,e):slice(t[r],e))),checkType$1=t=>Object.prototype.toString.call(t).replace(/\[|object\s|\]/g,"").toLowerCase(),isNumber=t=>"number"===checkType$1(t),isRange=t=>t instanceof Range,slice=(t,e)=>isRange(e)?rangeSlice(t,e):1===e.length&&isNumber(e[0])?numberSlice(t,e[0]):arraySlice(t,e),parseCloudLocation=t=>{const[e,r,n,i]=t.match(/([a-z]+):\/\/([^\/]+)\/(.*)/);return{protocol:r,host:n,path:i}},supported=["tcp","ipc","ws"],remote=async(t,e)=>{const{protocol:r,host:n,path:i}=parseCloudLocation(e);if(!supported.includes(r))throw new Error(`Protocol "${r}" is not supported.`);const s=await t.distributed.getExecutor(r,n),o=await s.getFunctions(i),f={};for(const t in o)f[t.slice(i.length+1)]=o[t];return f};var format=(...t)=>t.map((t=>`${t}`)).join("");const Any=Symbol("Any"),help=t=>console.log(t.__doc__),describe=(t,e)=>(e.__doc__=t,e),returns=(t,e)=>(e.__returns__=t,e),params=(...t)=>{const e=t.pop();return e.__accepts__=t,e},checkType=(t,e)=>Array.isArray(e)?!!Array.isArray(t)&&t.every((t=>checkType(t,e[0]))):e===Number?"number"==typeof t||t instanceof Number:e===String?"string"==typeof t||t instanceof String:t instanceof e,nameOfType=t=>Array.isArray(t)?`Array[${nameOfType(t[0])}]`:t?.constructor?.name||Object.prototype.toString.call(t).slice(8,-1),typeName=t=>Array.isArray(t)?`Array[${typeName(t[0])}]`:t?.name||Object.prototype.toString.call(t).slice(8,-1),check=t=>{const e=(...r)=>{if(e.__accepts__)for(let t=0;t<r.length;t++){const n=r[t],i=e.__accepts__[t];if(!checkType(n,i)){const e=nameOfType(n),r=typeName(i);throw new Error(`Argument of type ${e} at position ${t} does not satisfy parameter of type ${r}`)}}const n=t(...r);if(e.__returns__){if(!checkType(n,e.__returns__)){const t=typeName(e.__returns__),r=nameOfType(n);throw new Error(`Returned value ${n} with type ${r} does not satisfy return type of ${t}`)}}return n};return e.__accepts__=t.__accepts__,e.__doc__=t.__doc__,e.__returns__=t.__returns__,e};var builtins=Object.freeze({__proto__:null,EventEmitter:EventEmitter,emitter:emitter,slice:slice,remote:remote,randomId:randomId$1,f:format,Any:Any,range:range,help:help,describe:describe,returns:returns,check:check,params:params});function randomId(){return Math.floor(4294967295*Math.random())}class PacketParser extends EventEmitter{constructor(t){super(),this.socket=t,this.size=0,this.data=null,this.socket.on("data",(t=>{for(this.data=this.data?Buffer.concat([this.data,t]):t,0===this.size&&this.data.length>=2&&(this.size=this.data.readUInt16LE(),this.data=this.data.slice(2));this.size&&this.data.length>=this.size;){const t=this.data.slice(0,this.size);if(this.emit("message",t),this.data.length>=this.size+2){const t=this.data.readUInt16LE(this.size);this.data=this.data.slice(this.size+2),this.size=t}else this.data=this.data.slice(this.size),this.size=0}}))}}var constructors$1=[{constructor:RegExp,code:0,args:t=>[t.source,t.flags],build:(t,e)=>new RegExp(t,e)},{constructor:Date,code:1,args:t=>[t.valueOf()],build:t=>new Date(t)}];const typeNames=["null","undefined","uint8","uint16","uint32","uint64","uint128","uintn","int8","int16","int32","int64","int128","intn","float8","float16","float32","float64","float128","floatn","record","ref8","ref16","ref32","ref64","ref128","refn","utfz","string8","string16","string32","string64","string128","stringn","bin8","bin16","bin32","bin64","bin128","binN","true","false","date","date64","constructor8","constructor16","constructor32","array8","array16","array32","array64","array128","objectStart","objectEnd","setStart","setEnd","mapStart","mapEnd"],types=Object.fromEntries(typeNames.map(((t,e)=>[t,e])));var types_1=types,utfzLib={},generator={};const chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",getChar=t=>{if(t>=chars.length){const e=Math.floor(t/chars.length);return"_".repeat(e)+chars[t-e*chars.length]}return chars[t]},getChars=t=>new Array(t).fill().map(((t,e)=>getChar(e))),generate=(t,e=0)=>2==t?`\n      let ${getChar(e++)} = buf[offset++];\n      if (offset > end) {\n        ${getChar(e-1)} += high;\n        return String.fromCharCode(${getChars(e-1)});\n      }\n      if (${getChar(e-1)} === 0) {\n        return String.fromCharCode(${getChars(e-1)}, high);\n      }\n      ${getChar(e-1)} += high;\n      let ${getChar(e++)} = buf[offset++] + high;\n      return String.fromCharCode(${getChars(e)});\n    `:`\n    let ${getChar(e)} = buf[offset++];\n    if (offset > end) {\n      ${getChar(e)} += high;\n      return String.fromCharCode(${getChars(e)});\n    }\n    if (${getChar(e)} === 0) {\n      next = buf[offset++];\n      if (next === highCode) {\n        ${getChar(e)} = high;\n      } else {\n        highCode = next;\n        high = next << 8;\n        ${getChar(e)} = buf[offset++];\n        if (${getChar(e)} === 0) {\n          ${getChar(e)} = high;\n          offset++\n        } else {\n          ${getChar(e)} += high;\n        }\n        if (offset > end) {\n          return String.fromCharCode(${getChars(e)});\n        }\n      }\n    } else {\n      ${getChar(e)} += high;\n    }\n    ${generate(t-1,e+1)}\n  `,makefn$1=t=>{const e=generate(t);return new Function("buf","length","offset",`let highCode = 0; let high = 0; let next; end = offset + length; ${e}`)};generator.makefn=makefn$1;const{makefn:makefn}=generator,pack=(t,e,r,n)=>{const i=n;let s=0;for(let i=0;i<e;i++){const e=t.charCodeAt(i),o=e>>8;o!==s&&(r[i+n++]=0,r[i+n++]=o,s=o);const f=255&e;r[i+n]=f,f||(r[i+ ++n]=s)}return e+n-i},fromCharCode=String.fromCharCode,fns=new Array(66).fill(null).map(((t,e)=>e>=3?makefn(e):t)),unpack=(t,e,r)=>{if(0===e)return"";if(1===e)return fromCharCode(t[r]);if(2===e){const e=t[r++];return 0===e?"\0":fromCharCode(e,t[r])}if(e<=65)return fns[e](t,e,r);const n=r+e;let i=0,s=0;const o=[];for(let e=r;e<n;e++){const r=t[e];if(r)o.push(r+s);else{const n=t[e+1];e+=1,n===i?o.push(r+s):(i=n,s=n<<8)}}return fromCharCode.apply(null,o)};utfzLib.pack=pack,utfzLib.unpack=unpack;var require$$3=getAugmentedNamespace(_polyfillNode_buffer);const builtinConstructors=constructors$1,SIA_TYPES=types_1,utfz=utfzLib,{Buffer:BufferShim}=require$$3,BufferClass=void 0===Buffer?BufferShim:Buffer;class Sia{constructor({size:t=33554432,constructors:e=builtinConstructors}={}){this.map=new Map,this.buffer=BufferClass.alloc(t),this.offset=0,this.constructors=e,this.strings=0}reset(){this.offset=0,this.strings=0,this.map=new Map}writeString(t,e){return this.buffer.write(t,e)}writeUInt8(t){this.buffer[this.offset]=t,this.offset+=1}writeUInt16(t){this.buffer[this.offset]=255&t,this.buffer[this.offset+1]=t>>8,this.offset+=2}writeUInt32(t){this.buffer.writeUInt32LE(t,this.offset),this.offset+=4}writeInt8(t){this.buffer.writeInt8(t,this.offset),this.offset+=1}writeInt16(t){this.buffer.writeInt16LE(t,this.offset),this.offset+=2}writeInt32(t){this.buffer.writeInt32LE(t,this.offset),this.offset+=4}writeDouble(t){this.buffer.writeDoubleLE(t,this.offset),this.offset+=8}addString(t){const{length:e}=t;if(e<60){this.writeUInt8(SIA_TYPES.utfz);const r=utfz.pack(t,e,this.buffer,this.offset+1);return this.buffer.writeUInt8(r,this.offset),void(this.offset+=r+1)}const r=3*e;if(r<256){this.writeUInt8(SIA_TYPES.string8);const e=this.writeString(t,this.offset+1);this.buffer.writeUInt8(e,this.offset),this.offset+=e+1}else if(r<65536){this.writeUInt8(SIA_TYPES.string16);const e=this.writeString(t,this.offset+2);this.buffer.writeUInt16LE(e,this.offset),this.offset+=e+2}else{this.writeUInt8(SIA_TYPES.string32);const e=this.writeString(t,this.offset+4);this.buffer.writeUInt32LE(e,this.offset),this.offset+=e+4}}addRef(t){if(t<256)this.writeUInt8(SIA_TYPES.ref8),this.writeUInt8(t);else if(t<65536)this.writeUInt8(SIA_TYPES.ref16),this.writeUInt16(t);else{if(!(t<4294967296))throw`Ref size ${t} is too big`;this.writeUInt8(SIA_TYPES.ref32),this.writeUInt32(t)}}addNumber(t){return Number.isInteger(t)?this.addInteger(t):this.addFloat(t)}addInteger(t){t<0?t>=-128?(this.writeUInt8(SIA_TYPES.int8),this.writeInt8(t)):t>=-32768?(this.writeUInt8(SIA_TYPES.int16),this.writeInt16(t)):t>=-2147483648?(this.writeUInt8(SIA_TYPES.int32),this.writeInt32(t)):this.addFloat(t):t<256?(this.writeUInt8(SIA_TYPES.uint8),this.writeUInt8(t)):t<65536?(this.writeUInt8(SIA_TYPES.uint16),this.writeUInt16(t)):t<4294967296?(this.writeUInt8(SIA_TYPES.uint32),this.writeUInt32(t)):this.addFloat(t)}addFloat(t){this.writeUInt8(SIA_TYPES.float64),this.writeDouble(t)}startArray(t){if(t<256)this.writeUInt8(SIA_TYPES.array8),this.writeUInt8(t);else if(t<65536)this.writeUInt8(SIA_TYPES.array16),this.writeUInt16(t);else{if(!(t<4294967296))throw`Array of size ${t} is too big to serialize`;this.writeUInt8(SIA_TYPES.array32),this.writeUInt32(t)}}startObject(){this.writeUInt8(SIA_TYPES.objectStart)}endObject(){this.writeUInt8(SIA_TYPES.objectEnd)}startMap(){this.writeUInt8(SIA_TYPES.mapStart)}endMap(){this.writeUInt8(SIA_TYPES.mapEnd)}startSet(){this.writeUInt8(SIA_TYPES.setStart)}endSet(){this.writeUInt8(SIA_TYPES.setEnd)}addBoolean(t){const e=t?SIA_TYPES.true:SIA_TYPES.false;this.writeUInt8(e)}addNull(){this.writeUInt8(SIA_TYPES.null)}addUndefined(){this.writeUInt8(SIA_TYPES.undefined)}addCustomType(t,e){const{args:r,code:n}=this.itemToSia(t,e);if(n<256)this.writeUInt8(SIA_TYPES.constructor8),this.writeUInt8(n);else if(n<65536)this.writeUInt8(SIA_TYPES.constructor16),this.writeUInt16(n);else{if(!(n<4294967296))throw`Code ${n} too big for a constructor`;this.writeUInt8(SIA_TYPES.constructor32),this.writeUInt32(n)}this.serializeItem(r)}serializeItem(t){switch(typeof t){case"string":return void this.addString(t);case"undefined":return void this.addUndefined(t);case"number":return void this.addNumber(t);case"boolean":return void this.addBoolean(t);case"object":{if(null===t)return void this.addNull(t);const{constructor:e}=t;switch(e){case Object:this.startObject();for(const e in t){const r=this.map.get(e);r?this.addRef(r):(this.map.set(e,this.strings++),this.addString(e)),this.serializeItem(t[e])}return void this.endObject();case Array:this.startArray(t.length);for(const e of t)this.serializeItem(e);return;case Set:this.startSet();for(const e of t)this.serializeItem(e);return void this.endSet();case Map:this.startMap();for(const[e,r]of t)this.serializeItem(e),this.serializeItem(r);return void this.endMap();case Buffer:{const{length:e}=t;if(t.length<256)this.writeUInt8(SIA_TYPES.bin8),this.writeUInt8(e),t.copy(this.buffer,this.offset),this.offset+=e;else if(t.length<65536)this.writeUInt8(SIA_TYPES.bin16),this.writeUInt16(e),t.copy(this.buffer,this.offset),this.offset+=e;else{if(!(t.length<4294967296))throw`Buffer of size ${e} is too big to serialize`;this.writeUInt8(SIA_TYPES.bin32),this.writeUInt32(e),t.copy(this.buffer,this.offset),this.offset+=e}return}default:return void this.addCustomType(t,e)}}}}itemToSia(t,e){for(const r of this.constructors)if(r.constructor===e)return{code:r.code,args:r.args(t)};throw`Serialization of item ${t} is not supported`}serialize(t){return this.data=t,this.reset(),this.serializeItem(this.data),this.buffer.slice(0,this.offset)}}class DeSia{constructor({constructors:t=builtinConstructors,mapSize:e=256e3}={}){this.constructors=new Array(256);for(const e of t)this.constructors[e.code]=e;this.map=new Array(e),this.offset=0,this.strings=0}reset(){this.offset=0,this.strings=0}readKey(t){switch(t){case SIA_TYPES.ref8:{const t=this.readUInt8();return this.map[t]}case SIA_TYPES.ref16:{const t=this.readUInt16();return this.map[t]}case SIA_TYPES.ref32:{const t=this.readUInt32();return this.map[t]}case SIA_TYPES.utfz:{const t=this.readUInt8(),e=utfz.unpack(this.buffer,t,this.offset);return this.offset+=t,this.map[this.strings++]=e,e}case SIA_TYPES.string8:{const t=this.readUInt8(),e=this.readString(t);return this.map[this.strings++]=e,e}case SIA_TYPES.string16:{const t=this.readUInt16(),e=this.readString(t);return this.map[this.strings++]=e,e}case SIA_TYPES.string32:{const t=this.readUInt32(),e=this.readString(t);return this.map[this.strings++]=e,e}default:throw`Key of type ${t} is invalid.`}}readBlock(){const t=this.readUInt8();switch(t){case SIA_TYPES.utfz:{const t=this.readUInt8(),e=utfz.unpack(this.buffer,t,this.offset);return this.offset+=t,e}case SIA_TYPES.string8:{const t=this.readUInt8();return this.readString(t)}case SIA_TYPES.string16:{const t=this.readUInt16();return this.readString(t)}case SIA_TYPES.string32:{const t=this.readUInt32();return this.readString(t)}case SIA_TYPES.bin8:{const t=this.readUInt8(),e=BufferClass.allocUnsafeSlow(t);return this.buffer.copy(e,0,this.offset,this.offset+t),this.offset+=t,e}case SIA_TYPES.bin16:{const t=this.readUInt16(),e=BufferClass.allocUnsafeSlow(t);return this.buffer.copy(e,0,this.offset,this.offset+t),this.offset+=t,e}case SIA_TYPES.bin32:{const t=this.readUInt32(),e=BufferClass.allocUnsafeSlow(t);return this.buffer.copy(e,0,this.offset,this.offset+t),this.offset+=t,e}case SIA_TYPES.int8:return this.readInt8();case SIA_TYPES.int16:return this.readInt16();case SIA_TYPES.int32:return this.readInt32();case SIA_TYPES.uint8:return this.readUInt8();case SIA_TYPES.uint16:return this.readUInt16();case SIA_TYPES.uint32:return this.readUInt32();case SIA_TYPES.float64:return this.readDouble();case SIA_TYPES.constructor8:{const t=this.readUInt8(),e=this.readBlock(),r=this.constructors[t];if(r)return r.build(...e);throw`Constructor ${t} is unknown`}case SIA_TYPES.constructor16:{const t=this.readUInt16(),e=this.readBlock(),r=this.constructors[t];if(r)return r.build(...e);throw`Constructor ${t} is unknown`}case SIA_TYPES.constructor32:{const t=this.readUInt32(),e=this.readBlock(),r=this.constructors[t];if(r)return r.build(...e);throw`Constructor ${t} is unknown`}case SIA_TYPES.false:return!1;case SIA_TYPES.true:return!0;case SIA_TYPES.null:return null;case SIA_TYPES.undefined:return;case SIA_TYPES.objectStart:{const t={};let e=this.buffer[this.offset++];for(;e!==SIA_TYPES.objectEnd;)t[this.readKey(e)]=this.readBlock(),e=this.buffer[this.offset++];return t}case SIA_TYPES.mapStart:{const t=new Map;let e=this.buffer[this.offset];for(;e!==SIA_TYPES.mapEnd;)t.set(this.readBlock(),this.readBlock()),e=this.buffer[this.offset];return t}case SIA_TYPES.setStart:{const t=new Set;let e=this.buffer[this.offset];for(;e!==SIA_TYPES.setEnd;)t.add(this.readBlock()),e=this.buffer[this.offset];return t}case SIA_TYPES.array8:{const t=this.readUInt8(),e=new Array(t);for(let r=0;r<t;r++)e[r]=this.readBlock();return e}case SIA_TYPES.array16:{const t=this.readUInt16(),e=new Array(t);for(let r=0;r<t;r++)e[r]=this.readBlock();return e}case SIA_TYPES.array32:{const t=this.readUInt32(),e=new Array(t);for(let r=0;r<t;r++)e[r]=this.readBlock();return e}default:throw`Unsupported type: ${t}`}}readUInt8(){return this.buffer[this.offset++]}readUInt16(){return this.buffer[this.offset++]+(this.buffer[this.offset++]<<8)}readUInt32(){const t=this.buffer.readUInt32LE(this.offset);return this.offset+=4,t}readInt8(){return this.buffer.readInt8(this.offset++)}readInt16(){const t=this.buffer.readInt16LE(this.offset);return this.offset+=2,t}readInt32(){const t=this.buffer.readInt32LE(this.offset);return this.offset+=4,t}readDouble(){const t=this.buffer.readDoubleLE(this.offset);return this.offset+=8,t}readString(t){const e=this.buffer.toString("utf8",this.offset,this.offset+t);return this.offset+=t,e}deserialize(t){return this.buffer=t,this.reset(),this.readBlock()}}const _Sia=new Sia,_Desia=new DeSia,sia=t=>_Sia.serialize(t),desia=t=>_Desia.deserialize(t);var sia_1=sia,desia_1=desia,Sia_1=Sia,DeSia_1=DeSia,constructors=builtinConstructors;const{GET:GET$1,REGISTER:REGISTER,PATH:PATH}=TYPES;class Dispatcher extends EventEmitter{constructor(){super(),this.workers=new Map,this.clients=new Map,this.jobs=new Map,this.connectedWorkers=[],this.transports=[],this.index=0,this.setupSia()}setupSia(){this.desia=new DeSia_1}deserialize(t){return desia_1(t)}serialize(t){return BufferClass$1.from(sia_1(t))}kill(){for(const t of this.transports)t.kill&&t.kill()}addTransport(t){this.transports.push(t),t.on("message",((t,e)=>this.onMessage(t,e))),t.start()}getRouteInfo(t){this.desia.reset(),this.desia.buffer=t,this.desia.readInt8(),this.desia.readInt8();return[this.desia.readBlock(),this.desia.readBlock()]}getPayload(){return this.desia.readBlock()}onMessage(t,e){const[r,n]=this.getRouteInfo(e);this.clients.set(r,t),n?n.startsWith("worker://")||n.startsWith("executor://")?this.routeToSocket(n,e):this.routePath(n,e):this.routeSelf(t,r,this.getPayload())}routeToSocket(t,e){const r=this.clients.get(t);r&&r.send(e)}routePath(t,e){const r=this.getWorker(t);r?r.send(e):this.addJob(t,e)}routeSelf(t,e,r){const[n,i,s]=this.deserialize(r);if(i===GET$1){const r=[...this.workers.keys()].filter((t=>t.startsWith(s))),i=this.serialize([n,PATH,r]),o=this.serialize([null,e,i]);t.send(o)}else if(i===REGISTER){if(!s.length)return;for(const e of s){const r=this.workers.get(e)||[];this.workers.set(e,[...r,t])}for(const t of s){const e=this.jobs.get(t)||[];this.jobs.set(t,[]);for(const t of e)this.routePath(...t)}this.connectedWorkers.push(t);(this.listeners.workerConnected||[]).forEach((e=>e.call(this,t)))}}addJob(...t){const e=this.jobs.get(path)||[];this.jobs.set(path,[...e,t])}schedule(t){return this.index=this.index+1>=t?0:this.index+1,this.index}getWorker(t){const e=this.workers.get(t);if(!e)return;return e[this.schedule(e.length)]}expectWorkers(t){return new Promise((e=>{this.connectedWorkers.length>=t&&e();const r=()=>{const{length:n}=this.connectedWorkers;n>=t&&(this.off("workerConnected",r),e())};this.on("workerConnected",r)}))}}const{EVENT:EVENT,CALL:CALL,GET:GET}=TYPES;class Executor{constructor(t){this.transport=t,this.isConnected=!1,this.connect(),this.promises=new Map,this.emitters=new Map,this.id="executor://"+randomId(),this.packets=0,this.setupSia(),this.transport.register(this.id,this)}setupSia(){const t=[...constructors,{constructor:EventEmitter,code:17,args:t=>{const{destination:e}=this,r=(r,...n)=>{const i=this.serialize([t.id,EVENT,r,n]),s=this.serialize([this.id,e,i]);this.send(s)};return t.on(/.*/,r),this.emitters.set(t.id,{emitter:t,send:r}),[t.id,this.id]},build:(t,e)=>{if(this.emitters.has(t))return this.emitters.get(t);const r=new EventEmitter(t),n=(r,...n)=>{const i=this.serialize([t,EVENT,r,n]),s=this.serialize([this.id,e,i]);this.send(s)};return r.on(/.*/,n),this.emitters.set(t,{emitter:r,send:n}),r}}];this.sia=new Sia_1({constructors:t}),this.desia=new DeSia_1({constructors:t})}connect(){this.transport.on("message",(t=>this.onPacket(t))),this.transport.on("connect",(()=>this.onConnect())),this.transport.connect()}onConnect(){this.isConnected=!0}serialize(t){return BufferClass$1.from(this.sia.serialize(t))}deserialize(t){return this.desia.deserialize(t)}onPacket(t){const e=this.deserialize(t[2]),[r,n]=e;if(n===EVENT){const{emitter:t,send:n}=this.emitters.get(r);t.emitUnless(n,e[2],...e[3])}else this.promises.get(r).resolve(e[2])}call(t,e){const r=this.packets++,n=new Promise((t=>{this.promises.set(r,{resolve:t})})),i=this.serialize([r,CALL,e]),s=this.serialize([this.id,t,i]);return this.send(s),n}getFunction(t){return(...e)=>this.call(t,e)}async getFunctions(t){const e=this.packets++,r=new Promise((t=>{this.promises.set(e,{resolve:t})})),n=this.serialize([e,GET,t]),i=this.serialize([this.id,null,n]);this.send(i);const s=await r,o={};for(const t of s)o[t]=this.getFunction(t);return o}send(t){this.isConnected?this.transport.send(t):this.transport.on("connect",(()=>this.transport.send(t)))}}class WebWorkerSocket extends EventEmitter{constructor(t){super(),this.worker=t,this.connect()}kill(){this.worker.terminate()}connect(){this.worker.onmessage=t=>this.handleWorkerMessage(t.data),this.emit("connect")}handleWorkerMessage(t){this.emit("message",t)}send(t){this.worker.postMessage(t,[t.buffer])}}class inSocket{constructor(t){this.socket=t}send(t){this.socket.emit("message",desia_1(t))}}class Socket extends EventEmitter{constructor(t){super(),this.server=t,this.inSocket=new inSocket(this)}register(){}connect(){this.emit("connect")}send(t){this.server.handleIncoming(this.inSocket,t)}}class Server$3 extends EventEmitter{constructor(){super(),this.workers=[],this.ready=!1}kill(){for(const t of this.workers)t.kill()}start(){this.emit("listening"),this.ready=!0}addWorker(t){const e=new WebWorkerSocket(t);this.workers.push(e),e.on("message",(t=>this.handleIncoming(e,t)))}getTransport(){return new Socket(this)}handleIncoming(t,e){this.emit("message",t,Buffer.from(e))}}const cpu={},workerFn=function(){self.addEventListener("message",(()=>{const t=Date.now(),e=t+4;self.postMessage({st:t,et:e})}))},blobUrl=()=>URL.createObjectURL(new Blob(["(",workerFn.toString(),")()"],{type:"application/javascript"}));function sample(t,e,r){return new Promise((n=>{if(0===e){const e=Math.floor(t.reduce((function(t,e){return t+e}),0)/t.length);return n(Math.max(1,e))}map(r,(async function(i,s){t.push(reduce(r,s)),n(await sample(t,e-1,r))}))}))}function map(t,e){const r=[],n=[];for(let i=0;i<t;++i){const i=new Worker(blobUrl());i.addEventListener("message",(function(i){if(n.push(i.data),n.length===t){for(let e=0;e<t;++e)r[e].terminate();e(null,n)}})),r.push(i)}for(let e=0;e<t;++e)r[e].postMessage(e)}function reduce(t,e){const r=[];for(let n=0;n<t;++n){const i=e[n],s=r[n]=[];for(let r=0;r<t;++r){if(n===r)continue;let t=e[r];(i.st>t.st&&i.st<t.et||t.st>i.st&&t.st<i.et)&&s.push(r)}}return r.reduce((function(t,e){return Math.max(t,e.length)}),0)}async function getCPUCount(){return cpu.count||(cpu.count=window.navigator.hardwareConcurrency||await sample([],10,16)),cpu.count}function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}var cachedSetTimeout=defaultSetTimout,cachedClearTimeout=defaultClearTimeout;function runTimeout(t){if(cachedSetTimeout===setTimeout)return setTimeout(t,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(t,0);try{return cachedSetTimeout(t,0)}catch(e){try{return cachedSetTimeout.call(null,t,0)}catch(e){return cachedSetTimeout.call(this,t,0)}}}function runClearTimeout(t){if(cachedClearTimeout===clearTimeout)return clearTimeout(t);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(t);try{return cachedClearTimeout(t)}catch(e){try{return cachedClearTimeout.call(null,t)}catch(e){return cachedClearTimeout.call(this,t)}}}"function"==typeof global.setTimeout&&(cachedSetTimeout=setTimeout),"function"==typeof global.clearTimeout&&(cachedClearTimeout=clearTimeout);var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var t=runTimeout(cleanUpNextTick);draining=!0;for(var e=queue.length;e;){for(currentQueue=queue,queue=[];++queueIndex<e;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,e=queue.length}currentQueue=null,draining=!1,runClearTimeout(t)}}function nextTick(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];queue.push(new Item(t,e)),1!==queue.length||draining||runTimeout(drainQueue)}function Item(t,e){this.fun=t,this.array=e}Item.prototype.run=function(){this.fun.apply(null,this.array)};var title="browser",platform="browser",browser=!0,env={},argv=[],version="",versions={},release={},config={};function noop(){}var on=noop,addListener=noop,once=noop,off=noop,removeListener=noop,removeAllListeners=noop,emit=noop;function binding(t){throw new Error("process.binding is not supported")}function cwd(){return"/"}function chdir(t){throw new Error("process.chdir is not supported")}function umask(){return 0}var performance=global.performance||{},performanceNow=performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||function(){return(new Date).getTime()};function hrtime(t){var e=.001*performanceNow.call(performance),r=Math.floor(e),n=Math.floor(e%1*1e9);return t&&(r-=t[0],(n-=t[1])<0&&(r--,n+=1e9)),[r,n]}var startTime=new Date;function uptime(){return(new Date-startTime)/1e3}var browser$1={nextTick:nextTick,title:title,browser:browser,env:env,argv:argv,version:version,versions:versions,on:on,addListener:addListener,once:once,off:off,removeListener:removeListener,removeAllListeners:removeAllListeners,emit:emit,binding:binding,cwd:cwd,chdir:chdir,umask:umask,hrtime:hrtime,platform:platform,release:release,config:config,uptime:uptime};function normalizeArray(t,e){for(var r=0,n=t.length-1;n>=0;n--){var i=t[n];"."===i?t.splice(n,1):".."===i?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}function normalize(t){var e=isAbsolute(t),r="/"===substr(t,-1);return(t=normalizeArray(filter(t.split("/"),(function(t){return!!t})),!e).join("/"))||e||(t="."),t&&r&&(t+="/"),(e?"/":"")+t}function isAbsolute(t){return"/"===t.charAt(0)}function join(){var t=Array.prototype.slice.call(arguments,0);return normalize(filter(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))}function filter(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}var substr="b"==="ab".substr(-1)?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)};const header$3=BufferClass$1.alloc(2);class IPCSocket extends EventEmitter{constructor(t){super(),this.socket=t}send(t){header$3.writeUInt16LE(t.length,0),this.socket.write(BufferClass$1.from(header$3)),this.socket.write(t)}}class Server$2 extends EventEmitter{constructor(t){super(),this.ipcConfig=t||Server$2.defaultIPCConfig(),this.ready=!1}static getIPCPath({name:t}){const e=[browser$1?.cwd()||".",t];return"win32"==browser$1?.platform&&e.unshift("\\\\?\\pipe"),join(...e)}static defaultIPCConfig(){return{path:Server$2.getIPCPath({name:"ipc.sock"})}}createIPCServer(){if(!this.ipcConfig)return;const{path:t}=this.ipcConfig;this.ipcServer=createServer(),this.ipcServer.on("listening",(()=>this.onListening())),this.ipcServer.listen(t),this.ipcServer.on("connection",(t=>this.onIPCConnect(t)))}onListening(){this.ready=!0,this.emit("listening")}onIPCConnect(t){const e=new PacketParser(t),r=new IPCSocket(t);e.on("message",(t=>this.handleIncoming(r,t)))}handleIncoming(t,e){this.emit("message",t,e)}start(){return this.createIPCServer()}}const header$2=BufferClass$1.alloc(2);class Client$2 extends EventEmitter{constructor(t){super(),this.ipcConfig=t||Server$2.defaultIPCConfig(),this.map=new Map}register(t,e){this.map.set(t,e)}connect(){this.socket=connect(this.ipcConfig.path),this.parser=new PacketParser(this.socket),this.parser.on("message",(t=>this.onMessage(t))),this.socket.on("connect",(()=>this.emit("connect"))),this.socket.on("error",(t=>this.emit("error",t)))}send(t){header$2.writeUInt16LE(t.length,0),this.socket.write(BufferClass$1.from(header$2)),this.socket.write(t)}deserialize(t){return desia_1(t)}onMessage(t){const e=this.deserialize(t);this.map.get(e[1]).onPacket(e)}}async function ipc(t,e,r){const n=new Client$2({path:r});n.connect(),await new Promise((t=>n.on("connect",t)));const i=new Executor(n);return this.executors.set(t,i),i}const header$1=BufferClass$1.alloc(2);class TCPSocket extends EventEmitter{constructor(t){super(),this.socket=t}send(t){header$1.writeUInt16LE(t.length,0),this.socket.write(BufferClass$1.from(header$1)),this.socket.write(t)}}class Server$1 extends EventEmitter{constructor(t){super(),this.tcpConfig=t||Server$1.defaultTCPConfig(),this.ready=!1}static defaultTCPConfig(){return{port:4444,host:"0.0.0.0"}}createTCPServer(){if(!this.tcpConfig)return;const{port:t,host:e}=this.tcpConfig;this.tcpServer=createServer(),this.tcpServer.on("listening",(()=>this.onListening())),this.tcpServer.listen(t,e),this.tcpServer.on("connection",(t=>this.onTCPConnect(t)))}onListening(){this.ready=!0,this.emit("listening")}onTCPConnect(t){const e=new PacketParser(t),r=new TCPSocket(t);e.on("message",(t=>this.handleIncoming(r,t)))}handleIncoming(t,e){this.emit("message",t,e)}start(){return this.createTCPServer()}}const header=BufferClass$1.alloc(2);class Client$1 extends EventEmitter{constructor(t){super(),this.tcpConfig=t||Server$1.defaultTCPConfig(),this.map=new Map}register(t,e){this.map.set(t,e)}connect(){const{port:t,host:e}=this.tcpConfig;this.socket=connect(t,e),this.parser=new PacketParser(this.socket),this.parser.on("message",(t=>this.onMessage(t))),this.socket.on("connect",(()=>this.emit("connect"))),this.socket.on("error",(t=>this.emit("error",t)))}send(t){header.writeUInt16LE(t.length,0),this.socket.write(BufferClass$1.from(header)),this.socket.write(t)}deserialize(t){return desia_1(t)}onMessage(t){const e=this.deserialize(t);this.map.get(e[1]).onPacket(e)}}async function tcp(t,e,r){const[n,i]=r.split(":"),s=new Client$1({host:n,port:i});s.connect(),await new Promise((t=>s.on("connect",t)));const o=new Executor(s);return this.executors.set(t,o),o}class WSSocket extends EventEmitter{constructor(t){super(),this.socket=t}send(t){this.socket.send(t)}}class WebSocketWrap{constructor(t){this.socket=new WebSocket(t),this.listeners={},this.socket.onopen=t=>this.emit("open",t),this.socket.onclose=t=>this.emit("close",t),this.socket.onerror=t=>this.emit("error",t),this.socket.onmessage=async t=>this.emit("message",await t.data.arrayBuffer())}send(t){return this.socket.send(t)}emit(t,...e){return this.listeners[t]=this.listeners[t]||[],this.listeners[t].forEach((t=>t(...e))),this}on(t,e){return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),this}off(t,e){return this.listeners[t]=this.listeners[t]||[],this.listeners[t]=this.listeners[t].filter((t=>t!==e)),this}}var ws$1=WebSocketWrap;class Server extends EventEmitter{constructor(t){super(),this.wsConfig=t||Server.defaultWSConfig(),this.ready=!1}static defaultWSConfig(){return{port:8080,url:"ws://localhost:8080"}}createWSServer(){if(!this.wsConfig)return;const{port:t}=this.wsConfig;this.wsServer=new ws$1.Server({port:t}),this.wsServer.on("listening",(()=>this.onListening())),this.wsServer.on("connection",(t=>this.onWSConnect(t)))}onListening(){this.ready=!0,this.emit("listening")}onWSConnect(t){const e=new WSSocket(t);t.on("message",(t=>this.handleIncoming(e,t)))}handleIncoming(t,e){this.emit("message",t,e)}start(){return this.createWSServer()}}class Client extends EventEmitter{constructor(t){super(),this.wsConfig=t||Server.defaultWSConfig(),this.map=new Map}register(t,e){this.map.set(t,e)}connect(){const{url:t}=this.wsConfig;this.socket=new ws$1(t),this.socket.on("open",(()=>this.emit("connect"))),this.socket.on("error",(t=>this.emit("error",t))),this.socket.on("message",(t=>this.onData(t)))}deserialize(t){return desia_1(t)}send(t){this.socket.send(t)}onData(t){const e=this.deserialize(BufferClass$1.from(t));this.map.get(e[1]).onPacket(e)}}async function ws(t,e,r){const n=new Client({url:`${e}://${r}`});n.connect(),await new Promise((t=>n.on("connect",t)));const i=new Executor(n);return this.executors.set(t,i),i}const executors={ws:ws,ipc:ipc,tcp:tcp};class Distributed{constructor(t,e){this.map=new Map,this.isWorker=t,this.connection=e,this.executors=new Map}set(t,e){this.map.set(t,e),this.isWorker&&this.connection.register(t,e)}get(t){return this.connection.getFunction(t)}async getExecutor(t,e){const r=`${t}:${e}`;return this.executors.has(r)?this.executors.get(r):await executors[t].call(this,r,t,e)}}const workerDist=(t,e)=>new Distributed(!0,{register:(t,r)=>e.register({path:t,fn:r}),getFunction:e=>t.getFunction(e),getFunctions:e=>t.getFunctions(e)}),mainDist=t=>new Distributed(!1,{getFunction:e=>t.getFunction(e),getFunctions:e=>t.getFunctions(e)}),run=async(t,{worker:e,executor:r},{noMain:n=!1}={})=>{const i={distributed:e?workerDist(r,e):mainDist(r),isWorker:!!e,isMain:!e,exports:{},...builtins};i.register=(t,e)=>(i.distributed.set(t,e),e.parallel=i.distributed.get(t),e);const{main:s}=await t.default(i),o=browser$1?.argv||[];if(!e&&!n){const t=await s(o);return Array.isArray(t)?await Promise.all(t):await t}},getModule=async t=>{const e="data:text/javascript;base64,"+btoa(t);return await import(e)};function getWorkerURL(t){return"data:text/javascript;base64,"+btoa(`importScripts("${t}");`)}const exec=async(t,e)=>{const r=await getCPUCount(),n=await getModule(t),i=encodeURIComponent(t.replace(/%/g,"~~mod~~")),s=new Dispatcher,o=new Server$3;for(let t=0;t<r;t++){const t=new Worker(`${getWorkerURL(e)}#${i}`);o.addWorker(t)}return s.addTransport(o),s.expectWorkers(r).then((async()=>{const t=o.getTransport(),e=new Executor(t);await run(n,{executor:e},{noExit:!0})}))};return exports.exec=exec,Object.defineProperty(exports,"__esModule",{value:!0}),exports}({});
//# sourceMappingURL=exec.js.map
